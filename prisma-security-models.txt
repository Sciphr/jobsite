// Add these models to your prisma/schema.prisma file
// Copy and paste them into your schema file

model security_events {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  event_type String   @db.VarChar(50)
  severity   String   @default("low") @db.VarChar(20)
  ip_address String?  @db.Inet
  user_id    String?  @db.Uuid
  user_agent String?
  details    Json     @default("{}")
  created_at DateTime @default(now()) @db.Timestamp(6)

  // Relations
  users      users?   @relation("security_events_user_idTousers", fields: [user_id], references: [id], onDelete: SetNull)

  @@index([created_at])
  @@index([event_type])
  @@index([severity])
  @@index([ip_address])
  @@index([user_id])
}

model security_alerts {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  alert_type   String    @db.VarChar(50)
  severity     String    @default("medium") @db.VarChar(20)
  ip_address   String?   @db.Inet
  event_count  Int       @default(1)
  details      Json      @default("{}")
  resolved     Boolean   @default(false)
  resolved_at  DateTime? @db.Timestamp(6)
  resolved_by  String?   @db.Uuid
  created_at   DateTime  @default(now()) @db.Timestamp(6)

  // Relations
  resolved_by_user users? @relation("security_alerts_resolved_byTousers", fields: [resolved_by], references: [id], onDelete: SetNull)

  @@index([created_at])
  @@index([resolved])
  @@index([severity])
}

// Also add these relations to your existing users model:
// Add these lines inside your existing "model users {" block:

// Security relations
security_events_security_events_user_idTousers        security_events[] @relation("security_events_user_idTousers")
security_alerts_security_alerts_resolved_byTousers    security_alerts[] @relation("security_alerts_resolved_byTousers")